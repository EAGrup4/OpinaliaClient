<div class="container">
  <div class="header">
    <h1 class="title">Editar perfil</h1>
  </div>
  <p *ngFor="let alert of alerts" id="alertType">
    <ngb-alert [type]="alert.type" (close)="closeAlert(alert)">{{ alert.message }}</ngb-alert>
  </p>
  <form id="editForm" class="col-md-7" novalidate [formGroup]="myform">
    <div class="form-group"[ngClass]="{
    'has-danger': nameControl.invalid && (nameControl.dirty || nameControl.touched),
    'has-success': nameControl.valid && (nameControl.dirty || nameControl.touched)}">
      <label for="username3" class="control-label">Nombre de usuario:</label>
      <input type="text" class="form-control" formControlName="nameControl" id="username3" name="username2" value="{{this.user.name}}" title="Introduzca su nuevo nombre de usuario" placeholder="Exemple" #username2 required>
      <p *ngIf="(nameControl.errors && (nameControl.dirty || nameControl.touched)) && nameControl.errors.required">Introduzca nombre</p>
      <p *ngIf="(nameControl.errors && (nameControl.dirty || nameControl.touched)) && nameControl.errors.rangeLength">Tiene que tener minimo 4 letras</p>
      <span class="help-block"></span>
    </div>
    <div class="form-group" [ngClass]="{
    'has-danger': emailControl.invalid && (emailControl.dirty || emailControl.touched),
    'has-success': emailControl.valid && (emailControl.dirty || emailControl.touched)
    }">
      <label for="email3" class="control-label">Correo</label>
      <input type="text" class="form-control" formControlName="emailControl" id="email3" name="email2" value="{{this.user.email}}" title="Introduzca su nuevo correo" placeholder="exemplo@gmail.com" #email2 required>
      <p *ngIf="(emailControl.errors && (emailControl.dirty || emailControl.touched)) && emailControl.errors.required">Introduce email</p>
      <p *ngIf="(emailControl.errors && (emailControl.dirty || emailControl.touched)) && emailControl.errors.email">El formato del Email no es correcto</p>
      <span class="help-block"></span>
    </div>
    <div class="form-group" [ngClass]="{
    'has-danger': passwordControl.invalid && (passwordControl.dirty || passwordControl.touched),
    'has-success': passwordControl.valid && (passwordControl.dirty || passwordControl.touched)
    }">
      <label for="password3" class="control-label">Contraseña</label>
      <input type="password" class="form-control" id="password3" formControlName="passwordControl" name="password" value="" title="Introduzca su nueva contraseña" #password2 required>
      <span class="help-block"></span>
    </div>
    <div class="form-group">
      <label for="password33" class="control-label">Confirmar contraseña</label>
      <input type="password" class="form-control" id="password33" name="password" value="" title="Introduzca su nueva contraseña" #password22 required>
      <span class="help-block"></span>
    </div>
    <p><a class="btn btn-info btn-block" id='editUserButton' (click)="passUser(username2.value, email2.value, password2.value, password22.value)" data-toggle="modal" data-target="#myModal5">Editar usuario</a></p>
    <p><a id='deleteUserButton' class="btn btn-danger btn-block" data-toggle="modal" data-target="#myModal4">Borrar tu cuenta</a></p>
  </form>
  <div class="col-md-4 editform">
    <div class="form-group">
      <label class="control-label">Foto de perfil:</label>
      <input type='file' (change)="readUrl($event)">
      <img [src]="url" class="imageProduct">
      <span class="help-block" style="padding-top: 5%"></span>
      <button class="btn btn-default btn-block" (click)="imageProfile()">Canviar foto de perfil</button>
    </div>
  </div>
  <!-- Modal -->
  <div class="modal fade" id="myModal4" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content" id="moodal">
        <div class="modal-body">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">¿Seguro que quieres borrar tu cuenta?</h4>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" id='deleteUser' data-dismiss="modal" (click)="deleteUser()">Si, Borrar!</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal -->
  <div class="modal fade" id="myModal5" role="dialog" *ngIf="currentModal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">¿Seguro que quieres modificar su cuenta?</h4>
        </div>
        <div class="modal-body">
          <p>Nombre: {{ this.users.name }}</p>
          <p>Email: {{ this.users.email }}</p>
          <p>Contraseña: {{ this.users.password }}</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-info" id="editUser" data-dismiss="modal" (click)="modifyUsers(username2.value, email2.value, password2.value, password22.value)">Si, Modificar!</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>
